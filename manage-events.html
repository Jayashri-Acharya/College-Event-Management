<!DOCTYPE html>
<html>
<head>
  <title>Manage Events</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    *{
      margin:0;
      padding:0;
      box-sizing:border-box;
      font-family:'Inter', sans-serif;
    }

    body{
      display:flex;
      height:100vh;
      background:#f4f6f9;
    }

    .sidebar{
      width:240px;
      background:linear-gradient(180deg,#5f2c82,#49a09d);
      color:white;
      padding:30px 20px;
    }

    .sidebar h2{
      margin-bottom:40px;
      font-size:20px;
    }

    .menu{
      list-style:none;
    }

    .menu li{
      margin-bottom:15px;
    }

    .menu a{
      text-decoration:none;
      color:white;
      padding:10px 15px;
      display:block;
      border-radius:8px;
      transition:0.3s;
      font-size:14px;
    }

    .menu a:hover{
      background:rgba(255,255,255,0.2);
      transform:translateX(5px);
    }

    .main{
      flex:1;
      padding:40px;
      overflow:auto;
    }

    h1{
      margin-bottom:20px;
      color:#333;
    }

    .form-box{
      background:white;
      padding:20px;
      border-radius:12px;
      box-shadow:0 10px 25px rgba(0,0,0,0.05);
      margin-bottom:30px;
    }

    input, select, textarea{
      width:100%;
      padding:10px;
      margin-bottom:15px;
      border-radius:8px;
      border:1px solid #ddd;
    }

    button{
      padding:10px 20px;
      border:none;
      border-radius:8px;
      background:linear-gradient(90deg,#5f2c82,#49a09d);
      color:white;
      cursor:pointer;
      transition:0.3s;
    }

    button:hover{
      opacity:0.9;
    }

    table{
      width:100%;
      border-collapse:collapse;
      background:white;
      border-radius:12px;
      overflow:hidden;
      box-shadow:0 10px 25px rgba(0,0,0,0.05);
    }

    th, td{
      padding:12px;
      text-align:left;
      font-size:14px;
    }

    th{
      background:#f4f6f9;
    }

    tr{
      border-bottom:1px solid #eee;
    }

    .action-btn{
      padding:6px 12px;
      font-size:12px;
      border:none;
      border-radius:6px;
      cursor:pointer;
      color:white;
    }

    .edit-btn{
        background:#4CAF50;
    }


    .delete-btn{
      background:#f44336;
    }

  </style>
</head>

<body>

<div class="sidebar">
  <h2>Admin Panel</h2>
  <ul class="menu">
    <li><a href="admin-dashboard.html">Dashboard</a></li>
    <li><a href="#">Manage Events</a></li>
    <li><a href="#">Manage Competitions</a></li>
    <li><a href="#">View Registrations</a></li>
    <li><a href="#">Reports</a></li>
    <li><a href="login.html">Logout</a></li>
  </ul>
</div>

<div class="main">

<h1>Manage Events</h1>

<div class="form-box">
  <input type="text" id="eventName" placeholder="Event Name">

  <select id="eventClub">
    <option value="">Select Club / Association</option>
    <option>IT Club</option>
    <option>Cultural Club</option>
    <option>Youth Red Cross Club</option>
    <option>NSS Club</option>
    <option>Commerce Association</option>
    <option>Placement Cell</option>
    <option>Electro Literacy Club</option>
  </select>

  <input type="date" id="eventDate">
  <input type="text" id="eventVenue" placeholder="Venue">
  <textarea id="eventDescription" placeholder="Description"></textarea>

  <button onclick="addEvent()">Add Event</button>
</div>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Club</th>
      <th>Date</th>
      <th>Venue</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody id="eventsTableBody">
  </tbody>
</table>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, updateDoc, getDoc }
from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "PASTE_YOUR_API_KEY",
  authDomain: "PASTE_YOUR_AUTH_DOMAIN",
  projectId: "PASTE_YOUR_PROJECT_ID",
  storageBucket: "PASTE_YOUR_STORAGE_BUCKET",
  messagingSenderId: "PASTE_YOUR_SENDER_ID",
  appId: "PASTE_YOUR_APP_ID"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const eventsCollection = collection(db, "events");

let editId = null;

const formBtn = document.querySelector(".form-box button");

formBtn.addEventListener("click", async function(){

  const name = document.getElementById("eventName").value.trim();
  const club = document.getElementById("eventClub").value;
  const date = document.getElementById("eventDate").value;
  const venue = document.getElementById("eventVenue").value.trim();
  const description = document.getElementById("eventDescription").value.trim();

  if(!name || !club || !date || !venue){
    alert("âš  Please fill all required fields");
    return;
  }

  if(editId === null){
    await addDoc(eventsCollection, {
      name,
      club,
      date,
      venue,
      description,
      createdAt: new Date()
    });

    alert("âœ… Event Added Successfully");
  } 
  else {
    await updateDoc(doc(db, "events", editId), {
      name,
      club,
      date,
      venue,
      description
    });

    alert("âœ… Event Updated Successfully");
    editId = null;
    formBtn.innerText = "Add Event";
  }

  clearForm();
  loadEvents();
});

function clearForm(){
  document.getElementById("eventName").value = "";
  document.getElementById("eventClub").value = "";
  document.getElementById("eventDate").value = "";
  document.getElementById("eventVenue").value = "";
  document.getElementById("eventDescription").value = "";
}

async function loadEvents(){
  const querySnapshot = await getDocs(eventsCollection);
  const tableBody = document.getElementById("eventsTableBody");
  tableBody.innerHTML = "";

  querySnapshot.forEach((docSnap) => {
    const event = docSnap.data();
    const id = docSnap.id;

    const row = document.createElement("tr");

    row.innerHTML = `
      <td>${event.name}</td>
      <td>${event.club}</td>
      <td>${event.date}</td>
      <td>${event.venue}</td>
      <td>
        <button class="action-btn edit-btn">Edit</button>
        <button class="action-btn delete-btn">Delete</button>
      </td>
    `;

    // Attach Edit Event
    row.querySelector(".edit-btn").addEventListener("click", async () => {
      document.getElementById("eventName").value = event.name;
      document.getElementById("eventClub").value = event.club;
      document.getElementById("eventDate").value = event.date;
      document.getElementById("eventVenue").value = event.venue;
      document.getElementById("eventDescription").value = event.description;

      editId = id;
      formBtn.innerText = "Update Event";
      window.scrollTo({ top: 0, behavior: "smooth" });
    });

    // Attach Delete Event
    row.querySelector(".delete-btn").addEventListener("click", async () => {
      if(confirm("Are you sure you want to delete this event?")){
        await deleteDoc(doc(db, "events", id));
        alert("ðŸ—‘ Event Deleted Successfully");
        loadEvents();
      }
    });

    tableBody.appendChild(row);
  });
}

loadEvents();

</script>


</body>
</html>
