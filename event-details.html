<!DOCTYPE html>
<html>
<head>
<title>Event Details</title>
<style>
body{font-family:Inter;padding:40px;background:#f4f6f9;}
.box{
  background:#e8d9f3;
  padding:30px;
  border-radius:12px;
}
button{
  margin-top:20px;
  padding:8px 20px;
  background:#5f2c82;
  color:white;
  border:none;
  border-radius:6px;
}
.box p{
  margin:8px 0;
}
img{
  max-width:100%;
  margin-top:10px;
  border-radius:8px;
}
iframe{
  width:100%;
  height:400px;
  margin-top:10px;
  border-radius:8px;
}
</style>
</head>
<body>

<div class="box" id="details"></div>
<button onclick="history.back()">Back</button>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>

const supabaseClient = supabase.createClient(
"https://oszgllewojvqcbehrtub.supabase.co",
"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9zemdsbGV3b2p2cWNiZWhydHViIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIwMjYzODIsImV4cCI6MjA4NzYwMjM4Mn0.Doz6ApUcY1HLsAx7HH1EX1Lx0QNLg7R3gl12jLfsmD0"
);

const id = new URLSearchParams(window.location.search).get("id");

function renderFile(url){

  if(!url) return "Brochure not available";

  const lower = url.toLowerCase();

  if(lower.endsWith(".jpg") || lower.endsWith(".jpeg") || lower.endsWith(".png")){
    return `<img src="${url}" alt="Brochure Image">`;
  }

  if(lower.endsWith(".pdf")){
    return `<iframe src="${url}"></iframe>`;
  }

  return `<a href="${url}" target="_blank">Download Brochure File</a>`;
}

async function load(){

  const { data } =
    await supabaseClient
      .from("events")
      .select("*")
      .eq("id",id)
      .single();

  document.getElementById("details").innerHTML=`
    <h2>${data.theme}</h2>
    <p><strong>Category:</strong> ${data.category}</p>
    <p><strong>Venue:</strong> ${data.venue}</p>
    <p><strong>Date:</strong> ${data.date}</p>
    <p><strong>Time:</strong> ${data.time}</p>
    <p><strong>Audience:</strong> ${data.audience}</p>
    <p><strong>Resource Person:</strong> ${data.resourcePerson || "-"}</p>
    <p><strong>Brochure:</strong></p>
    ${renderFile(data.brochureLink)}
  `;
}

load();
</script>

</body>
</html>
